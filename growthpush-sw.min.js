!function t(n,e,r){function o(u,s){if(!e[u]){if(!n[u]){var c="function"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var l=e[u]={exports:{}};n[u][0].call(l.exports,function(t){var e=n[u][1][t];return o(e?e:t)},l,l.exports,t,n,e,r)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(t,n,e){function r(t){var n=null;return d.open().then(function(){return d.get("kvs","config").then(function(t){return null==t?Promise.reject("Config does not exist"):void(n=t)})}).then(function(){return self.registration.pushManager.getSubscription().then(function(t){var e="https://api.growthpush.com/1/trials?token="+c(t)+"&applicationId="+n.applicationId+"&secret="+n.credentialId;return Promise.resolve(e)})}).then(function(t){return self.fetch(t).then(function(t){return 200!==t.status?Promise.reject("Status code isn't 200"):Promise.resolve(t)})}).then(function(t){return t.json().then(function(t){return Promise.resolve(t)})}).then(function(t){var e=null==t.extra?"":"#"+encodeURIComponent(t.extra),r=null==t.extra?{}:JSON.parse(t.extra),o=null==r.title?n.title:r.title,i=null==r.icon?n.icon:r.icon;return self.registration.showNotification(o,{icon:i+e,body:t.text,tag:"growthpush-trialId="+t.trialId,vibrate:t.sound?1e3:0})})["catch"](function(t){})}function o(t){t.notification.close();var n={},e=t.notification.icon.match(/#(.+)/);return null!=e&&e.length>1&&(n=JSON.parse(decodeURIComponent(e[1]))),Promise.all([i(n),u(n)])}function i(t){return self.clients.openWindow&&"url"in t?self.clients.openWindow(t.url):self.clients.matchAll({type:"window"}).then(function(t){for(var n=0;n<t.length;n++){var e=t[n];if("/"===e.url&&"focus"in e)return e.focus()}return self.clients.openWindow?self.clients.openWindow("/"):void 0})}function u(t){var n="";return"growthpush"in t&&"notificationId"in t.growthpush&&(n="Launch@Notification-"+t.growthpush.notificationId),d.open().then(function(){return d.get("kvs","config").then(function(t){return null==t?Promise.reject("Config does not exist"):Promise.resolve(t)})}).then(function(t){var e="clientId="+t.clientId+"&code="+t.code,r=[s(e+"&name="+t.clickEventName)];return""!==n&&t.isDetailEvent&&r.push(s(e+"&name="+n)),Promise.all(r)})}function s(t){return self.fetch("https://api.growthpush.com/1/events",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t}).then(function(t){return 200!==t.status?Promise.reject("Status code isn't 200"):t.json().then(function(t){})})["catch"](function(t){})}function c(t){return null==t.subscriptionId?t.endpoint.split("/").pop():t.subscriptionId}var a=t("./utils/indexeddb-wrapper"),l="growthpush",f=1,d=new a["default"](l,f,[{name:"kvs"}]);self.addEventListener("install",function(t){t.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(t){t.waitUntil(self.clients.claim())}),self.addEventListener("push",function(t){t.waitUntil(r(t))}),self.addEventListener("notificationclick",function(t){t.waitUntil(o(t))})},{"./utils/indexeddb-wrapper":2}],2:[function(t,n,e){var r=function(){function t(t,n,e){this.db=null,this.dbName=t,this.dbVersion=n,this.stores=e}return t.prototype.open=function(){var t=this;return new Promise(function(n,e){if(null!=t.db)return n();var r=indexedDB.open(t.dbName,t.dbVersion);r.onupgradeneeded=function(n){var e=n.target.result;t.stores.forEach(function(t){e.objectStoreNames.contains(t.name)&&e.deleteObjectStore(t.name),e.createObjectStore(t.name,{autoIncrement:!1})})},r.onsuccess=function(e){t.db=e.target.result,n()},r.onerror=function(t){e("Could not open DB")}})},t.prototype.put=function(t,n,e){if(null==this.db)return Promise.reject(new Error("DB: "+this.dbName+" is not open"));var r=this.db.transaction([t],"readwrite"),o=r.objectStore(t);return new Promise(function(t,r){var i=o.put(e,n);i.onsuccess=function(n){t()},i.onerror=function(t){r("Could not put item")}})},t.prototype.get=function(t,n){if(null==this.db)return Promise.reject(new Error("DB: "+this.dbName+" is not open"));var e=this.db.transaction([t],"readwrite"),r=e.objectStore(t);return new Promise(function(t,e){var o=r.get(n);o.onsuccess=function(n){var e=n.target.result;t(e)},o.onerror=function(t){e("Could not get item")}})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r},{}]},{},[1]);